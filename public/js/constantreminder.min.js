function createAndShowNotification(){var a="checked"===$("#optionsAt").attr("checked"),b="Recurring Reminder",c="images/recurring.png",d=0;if(a){var c="images/scheduled.png";b="Scheduled Notification";var e=new Date,f=new Date,g=$("#hours").val(),h=$("#minutes").val();g&&h&&(f.setHours(g),f.setMinutes(h),e>f&&f.setDate(f.getDate()+1),d=f.getTime()-e.getTime())}var i=window.webkitNotifications.createNotification(c,b,$("#reminderText").val());if(!a){var j=$("#period").val(),k=0;switch($("#interval").val()){case"secs":k=1e3;break;case"mins":k=6e4;break;case"hours":k=36e5}d=k*j,i.onclose=function(){createAndShowNotification()}}setTimeout(function(){running&&i.show()},d)}function showPrompter(){$("#instructions").hide(),$("#prompter").show()}function showInstructions(){$("#prompter").hide(),$("#instructions").show(300)}function setReminder(a){var b={r:a,e:"1",i:"hours"},c="http://localhost:3000/?"+$.param(b);return document.location=c,!1}function checkPermissions(){var a=window.webkitNotifications;return void 0===a?(document.location="/nochrome",void 0):(0==a.checkPermission()?changeToEnabled():2==window.webkitNotifications.checkPermission()&&changeToDisabled(),void 0)}function changeToDisabled(){$("#enableNotifications").val("Notifications Disabled"),$("#enableNotifications").addClass("btn-danger"),$("#enableNotifications").removeClass("btn-info")}function changeToRunning(){running=!0,$("#start").val("Cancel"),$("#start").addClass("btn-danger"),$("#start").removeClass("btn-info")}function changeToNotRunning(){$("#start").val("Start reminding"),$("#start").addClass("btn-info"),$("#start").removeClass("btn-danger")}function changeToEnabled(){$("#enableNotifications").val("Notifications Enabled"),$("#enableNotifications").addClass("btn-success"),$("#enableNotifications").removeClass("btn-info"),$("#start").removeAttr("disabled"),$("#start").val("Start reminding"),$("#start").addClass("btn-info"),$("#start").removeClass("btn-disabled")}var running=!1;$(function(){"/nochrome"!=window.location&&checkPermissions()}),$(function(){var a=$.deparam.querystring();a&&(a.r&&(showPrompter(),$("#reminderText").val(a.r)),a.w&&"e"===a.w&&a.e&&a.i&&($("#optionsEvery").attr("checked","checked"),$("#period").val(a.e),$("#interval").val(a.i)),"a"===a.w&&a.h&&a.m&&($("#optionsAt").attr("checked","checked"),$("#hours").val(a.h),$("#minutes").val(a.m)))}),$("#enableNotifications").click(function(){0==window.webkitNotifications.checkPermission()||(window.webkitNotifications.requestPermission(checkPermissions),0==window.webkitNotifications.checkPermission()&&checkPermissions())}),$("#letsGo").click(showPrompter),$("#showInstructions").click(showInstructions),$("#start").click(function(){return running?(changeToNotRunning(),running=!1,void 0):(changeToRunning(),createAndShowNotification(),void 0)});